import{C as t,Ma as o,Na as u,o as n,s as c,va as a}from"./chunk-BPJZSODR.js";var d=class l{supabaseService=c(u);exercises=t([]);selectedCategory=t("all");searchQuery=t("");loading=t(!1);error=t(null);allExercises=this.exercises.asReadonly();isLoading=this.loading.asReadonly();loadError=this.error.asReadonly();filteredExercises=a(()=>{let e=this.exercises(),r=this.selectedCategory();r!=="all"&&(e=e.filter(i=>i.muscleGroup===r));let s=this.searchQuery().toLowerCase();return s&&(e=e.filter(i=>i.name.toLowerCase().includes(s)||i.muscleGroup.toLowerCase().includes(s)||i.equipment.toLowerCase().includes(s))),e});popularExercises=a(()=>[...this.exercises()].sort((e,r)=>r.rating-e.rating).slice(0,3));recentExercises=a(()=>this.exercises().slice(3,6));constructor(){this.loadExercises()}async loadExercises(){this.loading.set(!0),this.error.set(null);try{let e=await fetch(`${o.supabaseUrl}/functions/v1/exercises`,{headers:{Authorization:`Bearer ${o.supabaseAnonKey}`,"Content-Type":"application/json"}});if(!e.ok)throw new Error("Failed to load exercises");let s=(await e.json()).map(this.mapExercise);this.exercises.set(s)}catch(e){console.error("Error loading exercises:",e),this.error.set(e instanceof Error?e.message:"Failed to load exercises")}finally{this.loading.set(!1)}}async getById(e){let r=this.exercises().find(s=>s.id===e);if(r)return r;try{let s=await fetch(`${o.supabaseUrl}/functions/v1/exercises/${e}`,{headers:{Authorization:`Bearer ${o.supabaseAnonKey}`,"Content-Type":"application/json"}});if(!s.ok)return;let i=await s.json();return this.mapExercise(i)}catch(s){console.error("Error fetching exercise:",s);return}}setCategory(e){this.selectedCategory.set(e)}setSearchQuery(e){this.searchQuery.set(e)}getCategories(){return[{value:"all",label:"All"},{value:"chest",label:"Chest"},{value:"back",label:"Back"},{value:"legs",label:"Legs"},{value:"shoulders",label:"Shoulders"},{value:"biceps",label:"Biceps"},{value:"triceps",label:"Triceps"}]}mapExercise(e){return{id:e.id,name:e.name,muscleGroup:e.muscle_group,equipment:e.equipment,difficulty:e.difficulty,rating:parseFloat(e.rating)||0,description:e.description||"",tips:(e.tips||[]).map(r=>({title:r.title,description:r.description})),videoUrl:e.video_url||"",thumbnailUrl:e.thumbnail_url||"",targetMuscles:e.target_muscles||[],equipmentDetails:e.equipment_details||[],iconColor:e.icon_color||"bg-blue-100 text-blue-600"}}static \u0275fac=function(r){return new(r||l)};static \u0275prov=n({token:l,factory:l.\u0275fac,providedIn:"root"})};export{d as a};
