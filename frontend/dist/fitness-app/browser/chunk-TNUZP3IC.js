import{C as a,Ia as n,Na as u,o,s as i}from"./chunk-BPJZSODR.js";var c=class t{supabaseService=i(u);router=i(n);_error=a(null);_isSubmitting=a(!1);error=this._error.asReadonly();isSubmitting=this._isSubmitting.asReadonly();user=this.supabaseService.user;isAuthenticated=this.supabaseService.isAuthenticated;loading=this.supabaseService.loading;async signUp(s){this._error.set(null),this._isSubmitting.set(!0);try{let{data:e,error:r}=await this.supabaseService.client.auth.signUp({email:s.email,password:s.password,options:{data:{display_name:s.displayName}}});return r?(this._error.set(r.message),{success:!1,error:r.message}):e.user&&!e.session?{success:!0,error:"Please check your email to confirm your account."}:(await this.router.navigate(["/programs"]),{success:!0})}catch(e){let r=e instanceof Error?e.message:"An unexpected error occurred";return this._error.set(r),{success:!1,error:r}}finally{this._isSubmitting.set(!1)}}async signIn(s){this._error.set(null),this._isSubmitting.set(!0);try{let{error:e}=await this.supabaseService.client.auth.signInWithPassword({email:s.email,password:s.password});return e?(this._error.set(e.message),{success:!1,error:e.message}):(await this.router.navigate(["/programs"]),{success:!0})}catch(e){let r=e instanceof Error?e.message:"An unexpected error occurred";return this._error.set(r),{success:!1,error:r}}finally{this._isSubmitting.set(!1)}}async signOut(){try{await this.supabaseService.client.auth.signOut(),await this.router.navigate(["/login"])}catch(s){console.error("Error signing out:",s)}}async resetPassword(s){this._error.set(null),this._isSubmitting.set(!0);try{let{error:e}=await this.supabaseService.client.auth.resetPasswordForEmail(s,{redirectTo:`${window.location.origin}/reset-password`});return e?(this._error.set(e.message),{success:!1,error:e.message}):{success:!0}}catch(e){let r=e instanceof Error?e.message:"An unexpected error occurred";return this._error.set(r),{success:!1,error:r}}finally{this._isSubmitting.set(!1)}}async updatePassword(s){this._error.set(null),this._isSubmitting.set(!0);try{let{error:e}=await this.supabaseService.client.auth.updateUser({password:s});return e?(this._error.set(e.message),{success:!1,error:e.message}):{success:!0}}catch(e){let r=e instanceof Error?e.message:"An unexpected error occurred";return this._error.set(r),{success:!1,error:r}}finally{this._isSubmitting.set(!1)}}clearError(){this._error.set(null)}static \u0275fac=function(e){return new(e||t)};static \u0275prov=o({token:t,factory:t.\u0275fac,providedIn:"root"})};export{c as a};
